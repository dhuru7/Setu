<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <script>
        (function () {
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.replace("login.html");
            } else {
                const userType = localStorage.getItem('userType');
                if (userType !== 'worker') {
                    window.location.replace(userType === 'authority' ? "authority-dashboard.html" : "index.html");
                }
            }
        })();
    </script>
    <title>Assignments — Setu Worker</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="../static/css/worker-home.css">
    <link rel="stylesheet" href="../static/css/worker-assignments.css">
</head>

<body class="worker-portal">
    <!-- Sidebar Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="worker-sidebar">
        <div class="sidebar-header">
            <a href="worker-home.html" class="sidebar-logo">
                <span class="logo-text">Setu.</span>
            </a>
            <button id="close-sidebar-btn" class="sidebar-close" aria-label="Close menu">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <nav class="sidebar-nav">
            <a href="worker-home.html" class="nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                </svg>
                Home
            </a>
            <a href="worker-assignments.html" class="nav-link active">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15a2.25 2.25 0 012.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
                </svg>
                Assignments
            </a>
            <a href="worker-messages.html" class="nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
                </svg>
                Messages
            </a>
            <a href="worker-profile.html" class="nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                Profile
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-info">
                <div class="user-label">Signed in as</div>
                <div class="user-name" id="sidebar-user-name">Worker</div>
                <div class="user-role">Field Worker</div>
            </div>
            <button id="logout-btn" class="logout-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
                </svg>
                Log Out
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="worker-main">
        <!-- Header -->
        <header class="worker-header">
            <div class="header-left">
                <button id="open-sidebar-btn" class="menu-btn" aria-label="Open menu">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                </button>
                <h1 class="header-title">Assignments</h1>
            </div>
            <div class="header-right">
                <span class="status-indicator">On Duty</span>
            </div>
        </header>

        <!-- Content -->
        <div class="worker-content">
            <!-- Page Title -->
            <section class="greeting-section fade-in-up">
                <h2 class="greeting-text">Your Tasks</h2>
                <p class="greeting-sub">Manage and update your assigned work orders.</p>
            </section>

            <!-- Search -->
            <div class="search-bar fade-in-up delay-1">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <input type="text" id="search-input" placeholder="Search tasks by name or location...">
            </div>

            <!-- Filter Tabs -->
            <div class="filter-tabs fade-in-up delay-2">
                <button class="filter-tab active" data-filter="all">All <span class="count"
                        id="count-all">8</span></button>
                <button class="filter-tab" data-filter="assigned">Assigned <span class="count"
                        id="count-assigned">3</span></button>
                <button class="filter-tab" data-filter="in-progress">In Progress <span class="count"
                        id="count-progress">2</span></button>
                <button class="filter-tab" data-filter="completed">Completed <span class="count"
                        id="count-completed">3</span></button>
            </div>

            <!-- Assignments List -->
            <div id="assignments-list" class="assignments-list">
                <!-- Assignment 1 — Assigned -->
                <div class="assignment-card fade-in-up delay-3" data-status="assigned">
                    <div class="assignment-card-header">
                        <div class="assignment-type">
                            <div class="assignment-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                                </svg>
                            </div>
                            <div>
                                <div class="assignment-title">Pothole Repair — MG Road</div>
                                <div class="assignment-id">#A7F3D2E1</div>
                            </div>
                        </div>
                        <span class="assignment-status assigned">Assigned</span>
                    </div>
                    <div class="assignment-details">
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                            </svg>
                            MG Road, Sector 14
                        </div>
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                            </svg>
                            24 Feb 2026
                        </div>
                    </div>
                    <div class="assignment-description">
                        Large pothole reported on MG Road near the intersection. Multiple citizens complained about
                        vehicle damage. Requires immediate patching and asphalt work.
                    </div>
                    <div class="assignment-footer">
                        <div class="assigned-by">
                            <div class="assigned-by-avatar">RK</div>
                            Assigned by Rajesh Kumar
                        </div>
                        <div class="deadline-tag urgent">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Due Today
                        </div>
                    </div>
                    <button class="update-status-btn" data-task-id="A7F3D2E1">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182" />
                        </svg>
                        Update Status
                    </button>
                </div>

                <!-- Assignment 2 — In Progress -->
                <div class="assignment-card fade-in-up delay-4" data-status="in-progress">
                    <div class="assignment-card-header">
                        <div class="assignment-type">
                            <div class="assignment-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
                                </svg>
                            </div>
                            <div>
                                <div class="assignment-title">Street Light Fix — Block C</div>
                                <div class="assignment-id">#B4E2C1F8</div>
                            </div>
                        </div>
                        <span class="assignment-status in-progress">In Progress</span>
                    </div>
                    <div class="assignment-details">
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                            </svg>
                            Block C, Green Park
                        </div>
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                            </svg>
                            23 Feb 2026
                        </div>
                    </div>
                    <div class="assignment-description">
                        Three street lights not working in Block C residential area. Residents report safety concerns
                        during evening hours.
                    </div>
                    <div class="assignment-footer">
                        <div class="assigned-by">
                            <div class="assigned-by-avatar">SP</div>
                            Assigned by Suresh Patel
                        </div>
                        <div class="deadline-tag">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Due Tomorrow
                        </div>
                    </div>
                    <button class="update-status-btn" data-task-id="B4E2C1F8">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182" />
                        </svg>
                        Update Status
                    </button>
                </div>

                <!-- Assignment 3 — Completed -->
                <div class="assignment-card fade-in-up delay-5" data-status="completed">
                    <div class="assignment-card-header">
                        <div class="assignment-type">
                            <div class="assignment-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125" />
                                </svg>
                            </div>
                            <div>
                                <div class="assignment-title">Drain Cleaning — Main Market</div>
                                <div class="assignment-id">#C9D1A3B7</div>
                            </div>
                        </div>
                        <span class="assignment-status completed">Completed</span>
                    </div>
                    <div class="assignment-details">
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                            </svg>
                            Main Market, Ward 5
                        </div>
                        <div class="assignment-detail">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                            </svg>
                            22 Feb 2026
                        </div>
                    </div>
                    <div class="assignment-description">
                        Blocked drain near the main market causing waterlogging. Successfully cleared debris and
                        restored drainage flow.
                    </div>
                    <div class="assignment-footer">
                        <div class="assigned-by">
                            <div class="assigned-by-avatar">AK</div>
                            Assigned by Amit Khan
                        </div>
                        <div class="deadline-tag">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Done
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Status Update Modal -->
    <div id="status-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-handle"></div>
            <div class="modal-header">
                <div>
                    <h3 class="modal-title">Update Status</h3>
                    <p class="modal-subtitle" id="modal-task-name">Task #A7F3D2E1</p>
                </div>
                <button id="modal-close-btn" class="modal-close">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">New Status</label>
                    <div class="status-options">
                        <label class="status-option" data-value="in-progress">
                            <input type="radio" name="status" value="in-progress">
                            <div class="status-dot"></div>
                            <span class="status-option-text">In Progress — Work started</span>
                        </label>
                        <label class="status-option" data-value="on-hold">
                            <input type="radio" name="status" value="on-hold">
                            <div class="status-dot"></div>
                            <span class="status-option-text">On Hold — Waiting for resources</span>
                        </label>
                        <label class="status-option" data-value="completed">
                            <input type="radio" name="status" value="completed">
                            <div class="status-dot"></div>
                            <span class="status-option-text">Completed — Work finished</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Add Notes</label>
                    <textarea class="form-textarea" id="status-notes"
                        placeholder="Describe the work done or any issues faced..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Upload Proof (Optional)</label>
                    <div class="photo-upload-area" id="photo-upload">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" />
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" />
                        </svg>
                        <p>Tap to take a photo</p>
                        <span>or upload from gallery</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-modal-btn" class="btn-cancel">Cancel</button>
                <button type="button" id="submit-status-btn" class="btn-submit">Submit Update</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span id="toast-message">Status updated successfully!</span>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Sidebar Toggle
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const openSidebarBtn = document.getElementById('open-sidebar-btn');
            const closeSidebarBtn = document.getElementById('close-sidebar-btn');

            const openSidebar = () => { sidebar.classList.add('open'); sidebarOverlay.classList.add('show'); document.body.style.overflow = 'hidden'; };
            const closeSidebar = () => { sidebar.classList.remove('open'); sidebarOverlay.classList.remove('show'); document.body.style.overflow = ''; };

            openSidebarBtn?.addEventListener('click', openSidebar);
            closeSidebarBtn?.addEventListener('click', closeSidebar);
            sidebarOverlay?.addEventListener('click', closeSidebar);

            // User name
            const userProfile = JSON.parse(localStorage.getItem('userProfile')) || {};
            const sidebarUserName = document.getElementById('sidebar-user-name');
            if (sidebarUserName) sidebarUserName.textContent = userProfile.fullname || 'Worker';

            // Filter Tabs
            const filterTabs = document.querySelectorAll('.filter-tab');
            const cards = document.querySelectorAll('.assignment-card');

            filterTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    filterTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const filter = tab.dataset.filter;
                    cards.forEach(card => {
                        if (filter === 'all' || card.dataset.status === filter) {
                            card.style.display = '';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            });

            // Search
            const searchInput = document.getElementById('search-input');
            searchInput?.addEventListener('input', () => {
                const query = searchInput.value.toLowerCase();
                cards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    card.style.display = text.includes(query) ? '' : 'none';
                });
            });

            // Status Modal
            const modal = document.getElementById('status-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const cancelBtn = document.getElementById('cancel-modal-btn');
            const submitBtn = document.getElementById('submit-status-btn');
            const toast = document.getElementById('toast');
            const statusOptions = document.querySelectorAll('.status-option');

            const openModal = (taskId) => {
                document.getElementById('modal-task-name').textContent = `Task #${taskId}`;
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            };

            const closeModal = () => {
                modal.classList.remove('show');
                document.body.style.overflow = '';
                statusOptions.forEach(o => o.classList.remove('selected'));
            };

            document.querySelectorAll('.update-status-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openModal(btn.dataset.taskId);
                });
            });

            modalCloseBtn?.addEventListener('click', closeModal);
            cancelBtn?.addEventListener('click', closeModal);
            modal?.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

            // Status option selection
            statusOptions.forEach(option => {
                option.addEventListener('click', () => {
                    statusOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    option.querySelector('input').checked = true;
                });
            });

            // Submit
            submitBtn?.addEventListener('click', () => {
                closeModal();
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 3000);
            });

            // Logout
            document.getElementById('logout-btn')?.addEventListener('click', () => {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('userType');
                localStorage.removeItem('userProfile');
                window.location.replace('login.html');
            });
        });
    </script>
</body>

</html>