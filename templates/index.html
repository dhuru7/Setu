<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        // CRITICAL OPTIMIZATION: Instant Auth Redirect
        (function () {
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.replace("login.html");
            } else {
                // Role Check
                const userType = localStorage.getItem('userType');
                if (userType === 'authority') {
                    window.location.replace("authority-dashboard.html");
                }
            }
        })();
    </script>
    <script>
        (function () {
            try {
                const theme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
                document.documentElement.setAttribute('data-theme', theme);
            } catch (e) { }
        })();
    </script>
    <title>Setu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="../static/css/set1_style.css">
    <link rel="stylesheet" href="../static/css/set1_homestyle.css">
    <link rel="stylesheet" href="../static/css/home_redesign.css">
    <link rel="stylesheet" href="../static/css/navigation.css">
    <link rel="stylesheet" href="../static/css/settings.css">
    <link rel="stylesheet" href="../static/css/notifications.css">
    <script src="../static/js/notifications.js" defer></script>
    <script src="../static/js/settings.js" defer></script>
    <script src="../static/js/navigation.js" defer></script>
    <script src="../static/js/setu-ai.js" defer></script>
    <style>
        /* Prevent transitions on page load */
        .preload * {
            transition: none !important;
            -webkit-transition: none !important;
            -moz-transition: none !important;
            -ms-transition: none !important;
            -o-transition: none !important;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.body.classList.remove('preload');
        });
    </script>
</head>

<body
    class="antialiased pb-28 sm:pb-0 preload bg-[var(--bg-primary)] text-[var(--text-primary)] transition-colors duration-300">
    <nav class="hidden sm:flex desktop-sidebar">
        <div class="flex-shrink-0 flex justify-center pt-2 pb-6">
            <a href="index.html" class="logo !text-xl notranslate">
                <span id="animated-name-desktop-sidebar">Setu</span>
            </a>
        </div>
        <div class="flex-grow flex flex-col items-center justify-start space-y-1">
            <a href="index.html" title="Home" class="desktop-nav-link active" id="desktop-home-link">
                <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                </svg>
                <span class="desktop-nav-text">Home</span>
            </a>

            <!-- SEARCH in place of Feed -->
            <a href="search.html" title="Search" class="desktop-nav-link" id="desktop-search-link-swapped">
                <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <span class="desktop-nav-text">Search</span>
            </a>

            <!-- UPDATES (Feed) in place of Search -->
            <a href="updates.html" title="Updates" class="desktop-nav-link" id="desktop-updates-link">
                <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" />
                </svg>
                <span class="desktop-nav-text">Updates</span>
            </a>

            <button id="notification-btn-desktop" title="Notifications" class="desktop-nav-link w-full relative">
                <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                </svg>
                <span class="desktop-nav-text">Notifications</span>
                <span id="notification-unread-dot-desktop"
                    class="notification-unread-dot !top-3 !left-7 !right-auto hidden"></span>
            </button>
            <a href="profile.html" title="Profile" class="desktop-nav-link" id="desktop-profile-link">
                <svg class="flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span class="desktop-nav-text">Profile</span>
            </a>

        </div>
        <div class="flex-shrink-0 w-full flex flex-col items-center space-y-2 pb-2 mt-auto"></div>
    </nav>

    <div id="app" class="min-h-screen sm:pl-28">
        <header id="mobile-header" class="sm:hidden sticky top-0 z-40 py-2 px-2">
            <div class="nav-content-wrapper rounded-xl max-w-7xl mx-auto relative">
                <div class="flex justify-between items-center py-2 px-4">
                    <a href="index.html" class="logo w-24 transition-all duration-300 notranslate"><span
                            id="animated-name-mobile">Setu</span></a>
                    <div id="mobile-header-buttons" class="flex items-center space-x-2 transition-all duration-300">
                        <button id="setu-ai-btn-mobile" title="Setu AI Assistant"
                            class="btn btn-cta !p-2 !rounded-full ai-widget-container">
                            <svg class="w-5 h-5 flex-shrink-0 text-white original-icon" viewBox="0 0 24 24"
                                fill="currentColor">
                                <path
                                    d="M12.0001 1.99219L3.45911 12.0002L12.0001 22.0082L20.5411 12.0002L12.0001 1.99219Z" />
                            </svg>
                        </button>
                        <button id="notification-btn-mobile" class="btn btn-secondary !p-2 relative !rounded-full"
                            title="Notifications">
                            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                            </svg>
                            <span id="notification-unread-dot" class="notification-unread-dot hidden"></span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

            <!-- Welcome Section -->
            <div class="mb-8 fade-in-up">
                <h1 class="text-3xl font-extrabold text-[var(--text-primary)] tracking-tight">
                    Hello, <span id="user-greeting-name" class="text-[var(--accent-primary)]">Neighbor</span>! ðŸ‘‹
                </h1>
                <p class="text-[var(--text-muted)] mt-2 text-lg">Let's make our community better, together.</p>
            </div>

            <!-- Hero/Action Section -->
            <div class="action-widget-container relative overflow-hidden group mb-10 fade-in-up"
                style="animation-delay: 100ms;">

                <div class="relative z-10 text-center w-full">
                    <h2 class="text-2xl font-bold mb-2">Spot a problem?</h2>
                    <p class="text-[var(--text-secondary)] mb-6 max-w-md mx-auto">
                        Potholes, garbage, or broken lights? Report it in seconds and track the fix.
                    </p>

                    <a href="report.html" class="btn-report-issue mx-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>Report an Issue</span>
                    </a>
                </div>
            </div>

            <!-- Reports By You Section -->
            <div class="mb-10 fade-in-up" style="animation-delay: 200ms;">
                <div class="flex justify-between items-end mb-4">
                    <h3 class="text-xl font-bold text-[var(--text-primary)]">Your Reports</h3>
                    <a href="Userreport.html"
                        class="text-sm font-medium text-[var(--accent-primary)] hover:underline">View All</a>
                </div>

                <div id="home-user-reports" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <!-- Loading Skeleton -->
                    <div
                        class="p-4 rounded-xl border border-[var(--border-light)] bg-[var(--bg-secondary)] animate-pulse">
                        <div class="h-4 bg-gray-200 rounded w-3/4 mb-3 dark:bg-gray-700"></div>
                        <div class="h-3 bg-gray-200 rounded w-1/2 dark:bg-gray-700"></div>
                    </div>
                </div>
            </div>

            <!-- Reports In Your Area Section -->
            <div class="mb-24 fade-in-up" style="animation-delay: 300ms;">
                <div class="flex justify-between items-end mb-4">
                    <h3 class="text-xl font-bold text-[var(--text-primary)]">Happening Nearby</h3>
                    <a href="reportfeed.html"
                        class="text-sm font-medium text-[var(--accent-primary)] hover:underline">Explore Map</a>
                </div>

                <div id="home-public-reports" class="space-y-4">
                    <!-- Loading Skeleton -->
                    <div
                        class="p-4 rounded-xl border border-[var(--border-light)] bg-[var(--bg-secondary)] animate-pulse flex gap-4">
                        <div class="w-16 h-16 bg-gray-200 rounded-lg dark:bg-gray-700"></div>
                        <div class="flex-1 space-y-2 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 dark:bg-gray-700"></div>
                            <div class="h-3 bg-gray-200 rounded w-1/2 dark:bg-gray-700"></div>
                        </div>
                    </div>
                    <div
                        class="p-4 rounded-xl border border-[var(--border-light)] bg-[var(--bg-secondary)] animate-pulse flex gap-4">
                        <div class="w-16 h-16 bg-gray-200 rounded-lg dark:bg-gray-700"></div>
                        <div class="flex-1 space-y-2 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 dark:bg-gray-700"></div>
                            <div class="h-3 bg-gray-200 rounded w-1/2 dark:bg-gray-700"></div>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <div id="filter-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden"></div>
        <div id="filter-panel"
            class="fixed top-0 left-0 h-full w-80 max-w-full bg-[var(--bg-secondary)] shadow-xl z-50 transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
            <div class="p-4 border-b border-[var(--border-light)] flex justify-between items-center flex-shrink-0">
                <h3 class="text-lg font-semibold flex items-center text-[var(--text-primary)]">Filters</h3>
                <button id="close-filter-btn" class="text-[var(--text-muted)] hover:text-[var(--text-primary)]"><svg
                        class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg></button>
            </div>
            <div class="p-4 space-y-4 flex-grow overflow-y-auto flex items-center justify-center">
                <p class="text-center text-[var(--text-muted)] p-4 bg-[var(--bg-accent)] rounded-lg">Filters will be
                    available soon.</p>
            </div>
        </div>

        <div id="notification-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden"></div>
        <div id="notification-panel"
            class="fixed top-0 right-0 h-full w-80 max-w-full bg-[var(--bg-secondary)] shadow-xl z-50 transform translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
            <div class="p-4 border-b border-[var(--border-light)] flex justify-between items-center flex-shrink-0">
                <h3 class="text-lg font-semibold flex items-center text-[var(--text-primary)]">Notifications</h3>
                <button id="close-notification-btn"
                    class="text-[var(--text-muted)] hover:text-[var(--text-primary)]"><svg class="w-6 h-6"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg></button>
            </div>
            <div id="notification-content" class="flex-grow overflow-y-auto"></div>
        </div>

        <div class="mobile-floating-nav-container sm:hidden">
            <nav class="mobile-floating-nav">
                <a href="index.html" id="bottom-nav-home" class="mobile-nav-item active">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                    </svg>
                    <span class="label">Home</span>
                </a>

                <!-- Search (was Feed) -->
                <a href="search.html" id="bottom-nav-search" class="mobile-nav-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                    </svg>
                    <span class="label">Search</span>
                </a>

                <!-- Updates (was Search) -->
                <a href="updates.html" id="bottom-nav-updates" class="mobile-nav-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" />
                    </svg>
                    <span class="label">Updates</span>
                </a>

                <!-- Profile -->
                <a href="profile.html" id="bottom-nav-profile" class="mobile-nav-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span class="label">Profile</span>
                </a>
            </nav>
        </div>
    </div>

    <div id="setu-ai-container-desktop" class="hidden sm:block">
        <button id="setu-ai-btn" title="Setu AI Assistant"
            class="btn btn-cta !p-4 !rounded-full shadow-lg transform hover:scale-110 transition-transform duration-200 ai-widget-container">
            <svg class="w-8 h-8 flex-shrink-0 text-white original-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12.0001 1.99219L3.45911 12.0002L12.0001 22.0082L20.5411 12.0002L12.0001 1.99219Z" />
            </svg>
        </button>
    </div>

    <div id="modal-overlay">
        <div id="modal-content-wrapper"></div>
    </div>

    <div id="image-viewer-overlay"
        class="fixed inset-0 z-[120] flex items-center justify-center bg-black bg-opacity-80 backdrop-filter backdrop-blur-lg hidden">
        <button id="image-viewer-close">&times;</button>
        <img id="fullscreen-image" src="" alt="Full screen complaint image"
            class="max-w-[90vw] max-h-[90vh] transition-transform duration-200">
    </div>

    <div id="ai-info-modal-overlay"
        class="fixed inset-0 bg-black bg-opacity-60 backdrop-filter backdrop-blur-sm z-[130] hidden items-center justify-center p-4">
        <div id="ai-info-modal"
            class="bg-[var(--bg-secondary)] rounded-2xl shadow-xl max-w-sm w-full p-6 text-center transform scale-95 opacity-0 transition-all duration-300 ease-out">
            <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-[var(--bg-accent)] mb-4">
                <svg class="w-8 h-8 text-[var(--accent-primary)]" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.0001 1.99219L3.45911 12.0002L12.0001 22.0082L20.5411 12.0002L12.0001 1.99219Z" />
                </svg>
            </div>
            <h3 class="text-xl font-bold text-[var(--text-primary)] mb-2">Setu AI is Evolving!</h3>
            <p class="text-sm text-[var(--text-muted)] mb-6">
                Thank you for trying our new AI assistant! This feature is currently under active development. While it
                can perform some basic tasks, we're working hard to unlock its full potential. Stay tuned for exciting
                updates!
            </p>
            <button id="ai-info-got-it-btn" class="btn btn-primary w-full">Got it</button>
        </div>
    </div>

    <div id="google_translate_element"></div>
    <script type="module" src="../static/js/home.js"></script>
    <script type="module" src="../static/js/logout.js"></script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async defer></script>
    <script>
        function googleTranslateElementInit() { new google.translate.TranslateElement({ pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false }, 'google_translate_element'); }
    </script>

</body>

</html>