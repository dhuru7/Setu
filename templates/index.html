<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        // CRITICAL OPTIMIZATION: Instant Auth Redirect
        (function () {
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.replace("login.html");
            } else {
                // Role Check
                const userType = localStorage.getItem('userType');
                if (userType === 'authority') {
                    window.location.replace("authority-dashboard.html");
                }
            }
        })();
    </script>
    <title>Setu</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="../static/css/set1_home.css">
    <link rel="stylesheet" href="../static/css/set2_home.css">
    <link rel="stylesheet" href="../static/css/navigationbar.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../static/js/notifications.js" defer></script>
    <script src="../static/js/settings.js" defer></script>
</head>

<body>
    <!-- Header -->
    <header class="header slide-down">
        <a href="index.html" class="logo">Setu.</a>
        <button id="notification-btn-mobile" class="notification-btn" title="Notifications">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
            </svg>
            <span id="notification-unread-dot" class="notification-dot"></span>
        </button>
    </header>

    <!-- Greetings -->
    <section class="greeting-section fade-in" style="animation-delay: 0.1s;">
        <h1 class="greeting-text">
            Hello,
            <span class="greeting-name" id="user-greeting-name">User.</span>
        </h1>
    </section>

    <!-- Report Issue Card -->
    <div class="report-card fade-in" style="animation-delay: 0.2s;">
        <div class="report-card-header">
            <div class="report-title">
                <h2>Report Issue</h2>
                <p class="report-subtitle">Make your city better.</p>
            </div>
            <!-- Arrow Button redirects to Your Reports (Userreport.html) -->
            <a href="Userreport.html" class="arrow-btn" aria-label="Your Reports">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25" />
                </svg>
            </a>
        </div>

        <a href="report.html" class="take-photo-btn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" />
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" />
            </svg>
            Take Photo
        </a>
    </div>

    <!-- Nearby Issues -->
    <section class="fade-in" style="animation-delay: 0.3s;">
        <div class="section-header">
            <h3 class="section-title">Nearby Issues <span id="nearby-count-badge" class="count-badge">...</span></h3>
            <a href="reportfeed.html" class="explore-btn">
                Explore Reports
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor" width="14" height="14">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15 15l-6 6m0 0l-6-6m6 6V9a6 6 0 0112 0v3" />
                </svg>
            </a>
        </div>

        <div id="home-public-reports" class="issue-list">
            <!-- Populated by JS -->
        </div>
    </section>

    <!-- Bottom Navigation -->
    <div class="bottom-nav-container">
        <nav class="bottom-nav">
            <a href="index.html" class="nav-item active">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                </svg>
            </a>
            <a href="search.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
            </a>
            <a href="report.html" class="nav-item plus-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
            </a>
            <a href="updates.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
                </svg>
            </a>
            <a href="profile.html" class="nav-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                </svg>
            </a>
        </nav>
    </div>

    <!-- Notification & Filter Panels (Hidden by default, used by existing JS logic) -->
    <div id="notification-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden"></div>
    <div id="notification-panel"
        class="fixed top-0 right-0 h-full w-80 max-w-full bg-[var(--bg-secondary)] shadow-xl z-50 transform translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
        <div class="p-4 border-b border-[var(--border-light)] flex justify-between items-center flex-shrink-0">
            <h3 class="text-lg font-semibold flex items-center text-[var(--text-primary)]">Notifications</h3>
            <button id="close-notification-btn"
                class="text-[var(--text-muted)] hover:text-[var(--text-primary)]">&times;</button>
        </div>
        <div id="notification-content" class="flex-grow overflow-y-auto"></div>
    </div>

    <!-- Additional functional scripts -->
    <script type="module" src="../static/js/home.js"></script>
    <script type="module" src="../static/js/logout.js"></script>

    <!-- Google Translate (Hidden but present for functionality if needed) -->
    <div id="google_translate_element" style="display:none;"></div>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async defer></script>
    <script>
        function googleTranslateElementInit() { new google.translate.TranslateElement({ pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false }, 'google_translate_element'); }
    </script>
</body>

</html>